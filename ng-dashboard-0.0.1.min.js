(function(i){var r=i.module("ngDashboard",[]);r.factory("invokeIfDefined",function(){return function(r,n,e){if(i.isDefined(r[e])){n[e](r[e])}}})})(angular);(function(i,r){var n=i.module("ngDashboard");n.directive("widgetGroup",[function(){return{restrict:"E",scope:{groupData:"=groupData"},controller:["$scope","$http",function(n,e){if(i.isArray(n.groupData.data)){n.crossFilter=r(n.groupData.data)}else if(i.isString(n.groupData.dataUrl)){e({method:"GET",url:n.groupData.dataUrl}).success(function(i){n.crossFilter=r(i)}).error(function(i){throw i})}else{throw"No data array or data url specified for group "+n.groupData.name}}],link:function(i,r){r.addClass("widget-group")},templateUrl:"./template/widgetGroup.html"}}])})(angular,crossfilter);(function(i){var r=i.module("ngDashboard");function n(i){this.widgetProviders=i}n.prototype.createWidget=function(i,r,n){if(!this.widgetProviders[r]){throw"No widget with "+r+" registered"}return this.widgetProviders[r].createWidget(i,n)};r.provider("widgetFactory",[function(){var r={};var e={};this.registerWidgetProvider=function(i,n){r[i]=n};this.registerChartMixin=function(i,r){e[i]=r};this.$get=["$injector",function(t){i.forEach(e,function(i){if(i.initialize){t.invoke(i.initialize,i)}});i.forEach(r,function(i){if(i.initialize){t.invoke(i.initialize,i,e)}});return new n(r)}]}]);r.directive("widget",["widgetFactory","crossfilterUtils",function(i,r){return{restrict:"E",scope:{widgetData:"=widgetData",crossFilter:"=crossFilter"},link:function(n,e){var t,o,a;e.addClass("widget");var s=n.$watch("crossFilter",function(c){if(c){o=n.crossFilter.dimension(r.dimensionFunction(n.widgetData.dimension));var u=r.groupFunctions(n.widgetData.group);a=o.group().reduce(u.add,u.remove,u.init);t=i.createWidget(e.find("widget-body"),n.widgetData.type,{dimension:o,group:a,rawData:n.widgetData});s()}})},templateUrl:"./template/widget.html"}}])})(angular);(function(i){var r=i.module("ngDashboard");var n=/^([^\(]*)\(([^\)]*)\).*$/;r.factory("widgetExpressionParser",["$parse",function(i){return{parse:function(r){var e=n.exec(r);var t=e[1];var o=i(e[2]);return{functionName:t,parameters:o}},valueFunction:function(i){function r(r){var n=i({d:r});return n}return r}}}])})(angular);(function(i){var r=i.module("ngDashboard");r.provider("scaleParser",[function(){var r={};this.registerScaleProvider=function(i,n){r[i]=n};this.$get=["widgetExpressionParser","$injector",function(e,t){i.forEach(r,function(i){if(i.initialize){t.invoke(i.initialize,i)}});return new n(r,e)}]}]);function n(i,r){this.scaleProviders=i;this.widgetExpressionParser=r}n.prototype.parse=function(i){var r=this.widgetExpressionParser.parse(i);if(!this.scaleProviders[r.functionName]){throw"No scaleprovider "+r.functionName+" registered"}return this.scaleProviders[r.functionName].createScale(r.parameters)}})(angular);(function(i){var r=i.module("ngDashboard");r.provider("crossfilterUtils",[function(){var r={};this.addGroupFunctionProvider=function(i,n){r[i]=n};this.$get=["$parse","widgetExpressionParser","$injector",function(n,e,t){i.forEach(r,function(i){if(i.initialize){t.invoke(i.initialize,i)}});return{dimensionFunction:function(i){if(!i){throw"Expression is required to create crossfilter dimension"}return e.valueFunction(n(i))},groupFunctions:function(i){if(!i){throw"Expression is required to create crossfilter group"}if(!r[i.functionName]){throw"No groupfunction provider for "+i.functionName+" registered"}return r[i.functionName].buildGroup(i.parameters)}}}]}])})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerWidgetProvider("barchart",new n)}]);function n(){}n.prototype.initialize=["baseChartMixin","coordinateGridMixin","marginMixin","stackMixin","invokeIfDefined","colorMixin",function(i,r,n,e,t,o){this.baseChartMixin=i;this.coordinateGridMixin=r;this.invokeIfDefined=t;this.marginMixin=n;this.stackMixin=e;this.colorMixin=o}];n.prototype.createWidget=function(i,r){var n=dc.barChart(i[0]);this.baseChartMixin.configureChart(n,r);this.stackMixin.configureChart(n,r);this.coordinateGridMixin.configureChart(n,r);this.marginMixin.configureChart(n,r);this.colorMixin.configureChart(n,r);n.render();return n}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerWidgetProvider("boxPlot",new n)}]);function n(){}n.prototype.initialize=["baseChartMixin","coordinateGridMixin","marginMixin","colorMixin",function(i,r,n,e){this.baseChartMixin=i;this.coordinateGridMixin=r;this.marginMixin=n;this.colorMixin=e}];n.prototype.createWidget=function(i,r){var n=dc.boxPlot(i[0]);this.baseChartMixin.configureChart(n,r);this.coordinateGridMixin.configureChart(n,r);this.marginMixin.configureChart(n,r);this.colorMixin.configureChart(n,r);n.render();return n}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerWidgetProvider("heatmap",new n)}]);function n(){}n.prototype.initialize=["baseChartMixin","coordinateGridMixin","marginMixin","colorMixin","invokeIfDefined",function(i,r,n,e,t){this.baseChartMixin=i;this.coordinateGridMixin=r;this.invokeIfDefined=t;this.marginMixin=n;this.colorMixin=e}];n.prototype.createWidget=function(i,r){var n=dc.heatMap(i[0]);this.baseChartMixin.configureChart(n,r);this.coordinateGridMixin.configureChart(n,r);this.marginMixin.configureChart(n,r);this.colorMixin.configureChart(n,r);n.render();return n}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerWidgetProvider("linechart",new n)}]);function n(){}n.prototype.initialize=["baseChartMixin","coordinateGridMixin","marginMixin","stackMixin","invokeIfDefined","colorMixin",function(i,r,n,e,t,o){this.baseChartMixin=i;this.coordinateGridMixin=r;this.invokeIfDefined=t;this.marginMixin=n;this.stackMixin=e;this.colorMixin=o}];n.prototype.createWidget=function(i,r){var n=dc.lineChart(i[0]);this.baseChartMixin.configureChart(n,r);this.stackMixin.configureChart(n,r);this.coordinateGridMixin.configureChart(n,r);this.marginMixin.configureChart(n,r);this.colorMixin.configureChart(n,r);this.invokeIfDefined(r.rawData,n,"renderArea");this.invokeIfDefined(r.rawData,n,"renderDataPoints");this.invokeIfDefined(r.rawData,n,"interpolate");n.render();return n}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerWidgetProvider("piechart",new n)}]);function n(){}n.prototype.initialize=["baseChartMixin","invokeIfDefined","colorMixin",function(i,r,n){this.baseChartMixin=i;this.invokeIfDefined=r;this.colorMixin=n}];n.prototype.createWidget=function(i,r){var n=dc.pieChart(i[0]);var e=this.invokeIfDefined;var t=r.rawData;this.baseChartMixin.configureChart(n,r);this.colorMixin.configureChart(n,r);e(t,n,"slicesCap");e(t,n,"innerRadius");e(t,n,"radius");e(t,n,"cx");e(t,n,"cy");e(t,n,"minAngleForLabel");n.render();return n}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["scaleParserProvider",function(i){i.registerScaleProvider("linear",new n)}]);function n(){}n.prototype.createScale=function(i){var r=d3.scale.linear();var n=i({});e(r,n,"domain");e(r,n,"range");e(r,n,"rangeRound");e(r,n,"clamp");e(r,n,"ticks");return r};function e(i,r,n){if(r[n]){i[n](r[n])}}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerChartMixin("baseChartMixin",new n)}]);function n(){}n.prototype.initialize=["invokeIfDefined","$parse","widgetExpressionParser",function(i,r,n){this.invokeIfDefined=i;this.$parse=r;this.widgetExpressionParser=n}];n.prototype.configureChart=function(i,r){var n=r.rawData;var e=this.invokeIfDefined;i.dimension(r.dimension);if(n.group.name){i.group(r.group,n.group.name)}else{i.group(r.group)}e(n,i,"width");e(n,i,"minWidth");e(n,i,"height");e(n,i,"minHeight");e(n,i,"transitionDuration");if(n.keyAccessor){i.keyAccessor(this.widgetExpressionParser.valueFunction(this.$parse(n.keyAccessor)))}if(n.valueAccessor){i.valueAccessor(this.widgetExpressionParser.valueFunction(this.$parse(n.valueAccessor)))}if(n.titleAccessor){i.title(this.widgetExpressionParser.valueFunction(this.$parse(n.titleAccessor)))}this.setupLegend(i,n.legend)};n.prototype.setupLegend=function(i,r){if(!r){return}var n=this.invokeIfDefined;var e=dc.legend();n(r,e,"x");n(r,e,"y");n(r,e,"gap");n(r,e,"itemHeight");n(r,e,"horizontal");n(r,e,"legendWidth");n(r,e,"itemWidth");i.legend(e)}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerChartMixin("colorMixin",new n)}]);function n(){}n.prototype.initialize=["invokeIfDefined","$parse",function(i,r){this.invokeIfDefined=i;this.$parse=r}];n.prototype.configureChart=function(i,r){var n=r.rawData;var t=this.invokeIfDefined;t(n,i,"colorDomain");t(n,i,"linearColors");t(n,i,"ordinalColors");if(n.colorAccessor){i.colorAccessor(e(this.$parse(n.colorAccessor)))}if(n.calculateColorDomain){i.calculateColorDomain()}};function e(i){function r(r,n){return i({d:r,i:n})}return r}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerChartMixin("coordinateGridMixin",new n)}]);function n(){}n.prototype.initialize=["scaleParser","invokeIfDefined",function(i,r){this.scaleParser=i;this.invokeIfDefined=r}];n.prototype.configureChart=function(i,r){var n=this.invokeIfDefined;var e=r.rawData;if(e.x){i.x(this.scaleParser.parse(e.x))}n(e,i,"yAxisPadding");n(e,i,"yAxisLabel");n(e,i,"brushOn");n(e,i,"elasticX");n(e,i,"elasticY");n(e,i,"mouseZoomable");n(e,i,"renderHorizontalGridLines");n(e,i,"renderVerticalGridLines");if(e.xAxis){this.configureAxis(i.xAxis(),e.xAxis)}if(e.yAxis){this.configureAxis(i.yAxis(),e.yAxis)}};n.prototype.configureAxis=function(i,r){var n=this.invokeIfDefined;n(r,i,"orient");n(r,i,"ticks");n(r,i,"tickValues");n(r,i,"tickSize");n(r,i,"innerTickSize");n(r,i,"outerTickSize");n(r,i,"tickPadding");if(r.tickFormat){i.tickFormat(d3.format(r.tickFormat))}}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["widgetFactoryProvider",function(i){i.registerChartMixin("marginMixin",new n)}]);function n(){}n.prototype.initialize=["invokeIfDefined",function(i){this.invokeIfDefined=i}];n.prototype.configureChart=function(i,r){this.invokeIfDefined(r.rawData,i,"margins")}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["crossfilterUtilsProvider",function(i){i.addGroupFunctionProvider("array",new n)}]);function n(){}n.prototype.initialize=["$parse",function(i){this.$parse=i}];n.prototype.buildGroup=function(i){if(!i){throw"sum needs a groupParam"}return e(this.$parse(i.value))};function e(i){var r={init:function(){return[]},add:function(r,n){var e=i({v:n});r.push(e);return r},remove:function(r,n){var e=i({v:n});r.splice(r.indexOf(e),1);return r}};return r}})(angular);(function(i){var r=i.module("ngDashboard");r.config(["crossfilterUtilsProvider",function(i){i.addGroupFunctionProvider("sum",new n)}]);function n(){}n.prototype.initialize=["$parse",function(i){this.$parse=i}];n.prototype.buildGroup=function(i){if(!i){throw"sum needs a groupParam"}return e(this.$parse(i.value))};function e(i){var r={init:function(){return 0},add:function(r,n){var e=i({v:n});return r+e},remove:function(r,n){var e=i({v:n});return r-e}};return r}})(angular);